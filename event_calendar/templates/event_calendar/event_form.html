{% extends 'base.html' %}
{% load i18n %}

{% block content %}
<div class="container">
    <h1>{% if object %}{% trans "Редактировать событие" %}{% else %}{% trans "Создать событие" %}{% endif %}</h1>
    
    <form method="post">
        {% csrf_token %}
        <div class="form-group">
            {{ form.title.label_tag }} {{ form.title }}
        </div>
        <div class="form-group">
            {{ form.description.label_tag }} {{ form.description }}
        </div>
        {% if form.start_time_date.value %}
            {{ form.start_time }}  {# Hidden input for combined datetime #}
            <div class="form-group">
                {{ form.start_time_date.label_tag }} 
                <input type="date" name="start_time_date" id="id_start_time_date" class="form-control" value="{{ form.start_time_date.value|date:'Y-m-d' }}" readonly>
            </div>
            <div class="form-group">
                {{ form.start_time_time.label_tag }} 
                <input type="time" name="start_time_time" id="id_start_time_time" class="form-control" value="{{ form.start_time_time.value|time:'H:i' }}" required>
                {% if form.start_time_time.errors %}
                    <div class="alert alert-danger">
                        {{ form.start_time_time.errors }}
                    </div>
                {% endif %}
            </div>
        {% else %}
            <div class="form-group">
                {{ form.start_time.label_tag }} 
                <input type="datetime-local" name="start_time" id="id_start_time" class="form-control" value="{{ form.start_time.value|date:'Y-m-d\TH:i' }}" required>
                {% if form.start_time.errors %}
                    <div class="alert alert-danger">
                        {{ form.start_time.errors }}
                    </div>
                {% endif %}
            </div>
        {% endif %}
        <div class="form-group">
            {{ form.end_time.label_tag }} 
            <input type="datetime-local" name="end_time" id="id_end_time" class="form-control" value="{{ form.end_time.value|date:'Y-m-d\TH:i' }}" required>
        </div>
        <div class="form-group">
            {{ form.max_participants.label_tag }} {{ form.max_participants }}
        </div>
        <div class="form-group">
            {{ form.is_official.label_tag }} {{ form.is_official }}
        </div>
        <button type="submit" class="btn btn-primary">{% trans "Сохранить" %}</button>
        <a href="{% if object %}{% url 'event_calendar:event_detail' object.pk %}{% else %}{% url 'event_calendar:event_list' %}{% endif %}" class="btn btn-secondary">{% trans "Отмена" %}</a>
    </form>
</div>
{% endblock %}
