{% extends 'base.html' %}
{% load i18n %}

{% block content %}
<div class="container">
    <h1>{{ event.title }}</h1>
    
    <div class="card mb-4">
        <div class="card-body">
            <p class="card-text">{{ event.description }}</p>
            <p class="card-text">
                <strong>{% trans "Начало:" %}</strong> {{ event.start_time|date:"d.m.Y H:i" }}<br>
                <strong>{% trans "Конец:" %}</strong> {{ event.end_time|date:"d.m.Y H:i" }}<br>
                <strong>{% trans "Макс. участников:" %}</strong> {{ event.max_participants|default:"Без ограничений" }}<br>
                <strong>{% trans "Тип:" %}</strong> {% if event.is_official %}{% trans "Официальное" %}{% else %}{% trans "Пользовательское" %}{% endif %}<br>
                <strong>{% trans "Создатель:" %}</strong> {{ event.creator.username }}
            </p>
            
            {% if user == event.creator %}
                <a href="{% url 'event_calendar:event_update' event.pk %}" class="btn btn-primary">{% trans "Редактировать" %}</a>
            {% endif %}
        </div>
    </div>
    
    <h3>{% trans "Участники" %}</h3>
    <ul class="list-group">
        {% for participant in event.participants.all %}
            <li class="list-group-item">{{ participant.username }}</li>
        {% empty %}
            <li class="list-group-item">{% trans "Пока нет участников" %}</li>
        {% endfor %}
    </ul>
    
    {% if user.is_authenticated and user not in event.participants.all %}
        <form method="post" action="{% url 'event_calendar:event_join' event.pk %}" class="mt-3">
            {% csrf_token %}
            <button type="submit" class="btn btn-success">{% trans "Присоединиться" %}</button>
        </form>
    {% elif user in event.participants.all %}
        <form method="post" action="{% url 'event_calendar:event_leave' event.pk %}" class="mt-3">
            {% csrf_token %}
            <button type="submit" class="btn btn-warning">{% trans "Покинуть событие" %}</button>
        </form>
    {% endif %}
</div>
{% endblock %}
